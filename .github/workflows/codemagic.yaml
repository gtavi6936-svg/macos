workflows:

    sample-workflow:

            name: Codemagic Sample Workflow

                    max_build_duration: 120

                            instance_type: mac_mini_m2workflows:

                                android-workflow-id:

                                        name: Android Sample Workflow

                                                # .......    

                                                        # .......

                                                                # .......  

                                                                    ios-workflow-id:

                                                                            name: iOS Sample Workflow

                                                                                    # ......workflows:

                                                                                      ios-workflow:

                                                                                          name: iOS Workflow 

                                                                                              # ....

                                                                                                  environment:

                                                                                                        ios_signing:

                                                                                                                distribution_type: app_store # or: ad_hoc | development | enterprise

                                                                                                                        bundle_identifier: com.example.id
                                                                                                                          scripts:

                                                                                                                              # ... your dependencies installation

                                                                                                                                  

                                                                                                                                      - name: Set up code signing settings on Xcode project

                                                                                                                                            script: xcode-project use-profiles

                                                                                                                                                

                                                                                                                                                    # ... your build commands
                                                                                                                                                      

                                                                                                                                                        scripts:  

                                                                                                                                                            # ... your dependencies installation  

                                                                                                                                                                - name: Set up code signing settings on Xcode project  

                                                                                                                                                                      script: xcode-project use-profiles   

                                                                                                                                                                                      --custom-export-options='{"testFlightInternalTestingOnly": true}'  

                                                                                                                                                                                          # ... your build commands  
                                                                                                                                                                                            

                                                                                                                                                                                              scripts:  

                                                                                                                                                                                                  # ... your dependencies installation  

                                                                                                                                                                                                      - name: Set up code signing settings on Xcode project  

                                                                                                                                                                                                            script: xcode-project use-profiles   

                                                                                                                                                                                                                            --custom-export-options='{"testFlightInternalTestingOnly": true}'  

                                                                                                                                                                                                                                # ... your build commands  


                                                                                                                                                                                                                                ios-native:

                                                                                                                                                                                                                                  environment:

                                                                                                                                                                                                                                      vars:

                                                                                                                                                                                                                                            BUNDLE_ID: "io.codemagic.sample.iosnative"

                                                                                                                                                                                                                                                  XCODE_WORKSPACE: "CodemagicSample.xcworkspace" # <-- Name of your Xcode workspace

                                                                                                                                                                                                                                                        XCODE_SCHEME: "CodemagicSample" # <-- Name of your Xcode scheme

                                                                                                                                                                                                                                                        scripts:

                                                                                                                                                                                                                                                          # ...

                                                                                                                                                                                                                                                            - name: Build ipa for distribution

                                                                                                                                                                                                                                                                script: | 

                                                                                                                                                                                                                                                                      xcode-project build-ipa \

                                                                                                                                                                                                                                                                              --workspace "$CM_BUILD_DIR/$XCODE_WORKSPACE" \

                                                                                                                                                                                                                                                                                      --scheme "$XCODE_SCHEME"

                                                                                                                                                                                                                                                                                      artifacts:

                                                                                                                                                                                                                                                                                        - build/ios/ipa/*.ipa

                                                                                                                                                                                                                                                                                          - /tmp/xcodebuild_logs/*.log

                                                                                                                                                                                                                                                                                            - $HOME/Library/Developer/Xcode/DerivedData/**/Build/**/*.app

                                                                                                                                                                                                                                                                                              - $HOME/Library/Developer/Xcode/DerivedData/**/Build/**/*.dSYM

                                                                                                                                                                                                                                                                                              workflows:

                                                                                                                                                                                                                                                                                                ios-workflow:

                                                                                                                                                                                                                                                                                                    name: iOS Workflow

                                                                                                                                                                                                                                                                                                        integrations:

                                                                                                                                                                                                                                                                                                              app_store_connect: <App Store Connect API key name>

                                                                                                                                                                                                                                                                                                                  environment:

                                                                                                                                                                                                                                                                                                                        vars:

                                                                                                                                                                                                                                                                                                                                APP_STORE_APPLE_ID: 1555555551

                                                                                                                                                                                                                                                                                                                                    scripts:

                                                                                                                                                                                                                                                                                                                                          - name: Increment build number

                                                                                                                                                                                                                                                                                                                                                  script: | 

                                                                                                                                                                                                                                                                                                                                                            #!/bin/sh

                                                                                                                                                                                                                                                                                                                                                                      cd $CM_BUILD_DIR

                                                                                                                                                                                                                                                                                                                                                                                LATEST_BUILD_NUMBER=$(app-store-connect get-latest-app-store-build-number "$APP_STORE_APPLE_ID")

                                                                                                                                                                                                                                                                                                                                                                                          agvtool new-version -all $(($LATEST_BUILD_NUMBER + 1))

                                                                                                                                                                                                                                                                                                                                                                                                - name: Build ipa for distribution

                                                                                                                                                                                                                                                                                                                                                                                                      script: | 

                                                                                                                                                                                                                                                                                                                                                                                                              # build command
                                                                                                                                                                                                                                                                                                                                                                                                              workflows:

                                                                                                                                                                                                                                                                                                                                                                                                                sample-workflow-id:

                                                                                                                                                                                                                                                                                                                                                                                                                    environment: 

                                                                                                                                                                                                                                                                                                                                                                                                                          # ...

                                                                                                                                                                                                                                                                                                                                                                                                                              scripts: 

                                                                                                                                                                                                                                                                                                                                                                                                                                    # ...

                                                                                                                                                                                                                                                                                                                                                                                                                                        publishing: 

                                                                                                                                                                                                                                                                                                                                                                                                                                              email:

                                                                                                                                                                                                                                                                                                                                                                                                                                                      recipients:

                                                                                                                                                                                                                                                                                                                                                                                                                                                                - user_1@example.com

                                                                                                                                                                                                                                                                                                                                                                                                                                                                          - user_2@example.com

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  notify:

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            success: true

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      failure: false
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      # Integration section is required to make use of the keys stored in 

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      # Codemagic UI under Apple Developer Portal integration.

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      integrations:

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        app_store_connect: <App Store Connect API key name>



                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        publishing:

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          app_store_connect:

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              # Use referenced App Store Connect API key to authenticate binary upload

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  auth: integration 



                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      # Configuration related to TestFlight (optional)



                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          # Optional boolean, defaults to false. Whether or not to submit the uploaded

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              # build to TestFlight beta review. Required for distributing to beta groups.

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  # Note: This action is performed during post-processing.

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      submit_to_testflight: true 



                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          # Optional boolean, defaults to false. Set to true to automatically expire 

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              # previous build in review or waiting for review in Testflight before

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  # submitting a new build to beta review. Expired builds will no longer be available for testers.

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      # Note: This action is performed during post-processing.

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          expire_build_submitted_for_review: true



                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              # Specify the names of beta tester groups that will get access to the build 

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  # once it has passed beta review.

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      beta_groups: 

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            - group name 1

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  - group name 2

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          # Configuration related to App Store (optional)



                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              # Optional boolean, defaults to false. Whether or not to submit the uploaded

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  # build to App Store review. Note: This action is performed during post-processing.

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      submit_to_app_store: true



                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          # Optional boolean, defaults to false. Set to true to cancel the previous 

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              # submission (if applicable) when submitting a new build to App Store review.

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  # This allows automatically submitting a new build for review if a previous submission exists.

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      # Note: This action is performed during post-processing.

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          cancel_previous_submissions: true

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  # Optional, defaults to MANUAL. Supported values: MANUAL, AFTER_APPROVAL or SCHEDULED

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      release_type: SCHEDULED



                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          # Optional. Timezone-aware ISO8601 timestamp with hour precision when scheduling

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              # the release. This can be only used when release type is set to SCHEDULED.

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  # It cannot be set to a date in the past.

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      earliest_release_date: 2021-12-01T14:00:00+00:00 

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              # Optional. The name of the person or entity that owns the exclusive rights

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  # to your app, preceded by the year the rights were obtained.

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      copyright: 2021 Nevercode Ltd

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            # Optional boolean. Whether or not to release an App Store version update in phases.

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                # With this option turned on, your version update will be released over a 7-day period

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    # to a percentage of your users (selected at random by their Apple ID) with automatic

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        # updates turned on. Learn more from 

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            # https://developer.apple.com/help/app-store-connect/update-your-app/release-a-version-update-in-phases.

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                # If not specified, then App Store version default phased release configuration is reused.

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    phased_release: true


                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    workflows:

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      ios-native-workflow:

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          name: iOS Native

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              max_build_duration: 120

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  instance_type: mac_mini_m2

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      integrations:

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            app_store_connect: codemagic

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                environment:

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      ios_signing:

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              distribution_type: app_store

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      bundle_identifier: io.codemagic.sample.iosnative

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            vars:

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    BUNDLE_ID: "io.codemagic.sample.iosnative"

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            XCODE_WORKSPACE: "CodemagicSample.xcworkspace" # <-- Put the name of your Xcode workspace here

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    XCODE_SCHEME: "CodemagicSample" # <-- Put the name of your Xcode scheme here

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            APP_STORE_APPLE_ID: 1555555551

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  xcode: latest

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        cocoapods: default

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            scripts:

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  - name: Install CocoaPods dependencies

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          script: | 

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    pod install

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          - name: Set up provisioning profiles settings on Xcode project

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  script: xcode-project use-profiles

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        - name: Increment build number

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                script: | 

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          cd $CM_BUILD_DIR

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    LATEST_BUILD_NUMBER=$(app-store-connect get-latest-app-store-build-number "$APP_STORE_APPLE_ID")

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              agvtool new-version -all $(($LATEST_BUILD_NUMBER + 1))

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    - name: Build ipa for distribution

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            script: | 

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      xcode-project build-ipa \

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  --workspace "$CM_BUILD_DIR/$XCODE_WORKSPACE" \

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              --scheme "$XCODE_SCHEME"

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  artifacts:

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        - build/ios/ipa/*.ipa

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              - /tmp/xcodebuild_logs/*.log

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    - $HOME/Library/Developer/Xcode/DerivedData/**/Build/**/*.app

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          - $HOME/Library/Developer/Xcode/DerivedData/**/Build/**/*.dSYM

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              publishing:

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    email:

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            recipients:

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      - user_1@example.com

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                - user_2@example.com

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        notify:

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  success: true

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            failure: false

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  app_store_connect:

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          auth: integration



                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  # Configuration related to TestFlight (optional)

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          # Note: This action is performed during post-processing.

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  submit_to_testflight: true

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          beta_groups: # Specify the names of beta tester groups that will get access to the build once it has passed beta review.

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    - group name 1

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              - group name 2



                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      # Configuration related to App Store (optional)

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              # Note: This action is performed during post-processing.

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      submit_to_app_store: false

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      